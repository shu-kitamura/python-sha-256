from src.sha256 import padding, preprocess


def test_padding():
    assert padding("test") == b'\x74\x65\x73\x74' + b'\x80' + (b'\x00' * 51) + b'\x00\x00\x00\x00\x00\x00\x00\x20'
    assert padding("") == b'\x80' + (b'\x00' * 62) + b'\x00'
    assert padding("a" * 55) == (b'\x61' * 55) + b'\x80' + b'\x00\x00\x00\x00\x00\x00\x01\xb8'
    assert padding("a" * 56) == (b'\x61' * 56) + b'\x80' + (b'\x00' * 63) + b'\x00\x00\x00\x00\x00\x00\x01\xc0'
    assert padding("a" * 120) == (b'\x61' * 120) + b'\x80' + (b'\x00' * 63) + b'\x00\x00\x00\x00\x00\x00\x03\xc0'

def test_preprocess():
    input_str1 = "test"
    expect1 = [[
        b'\x74\x65\x73\x74', b'\x80\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x20',
    ]]
    assert preprocess(input_str1) == expect1

    input_str2 = "a" * 56
    expect2 = [[
        b'\x61\x61\x61\x61', b'\x61\x61\x61\x61', b'\x61\x61\x61\x61', b'\x61\x61\x61\x61',
        b'\x61\x61\x61\x61', b'\x61\x61\x61\x61', b'\x61\x61\x61\x61', b'\x61\x61\x61\x61',
        b'\x61\x61\x61\x61', b'\x61\x61\x61\x61', b'\x61\x61\x61\x61', b'\x61\x61\x61\x61',
        b'\x61\x61\x61\x61', b'\x61\x61\x61\x61', b'\x80\x00\x00\x00', b'\x00\x00\x00\x00',
    ],[
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x01\xc0',
    ]]
    assert preprocess(input_str2) == expect2

    input_str3 = "hello"
    expect3 = [[
        b'\x68\x65\x6c\x6c', b'\x6f\x80\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00',
        b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x28'
    ]]
    assert preprocess(input_str3) == expect3
